# Спецификация системы инвентаря

## Обзор

Система инвентаря управляет всеми предметами в игре, включая экипировку, зелья, подарки и ресурсы. Система обеспечивает хранение, использование и торговлю предметами, а также влияет на характеристики персонажа через экипировку.

## Архитектура

### Класс InventorySystem

```python
class InventorySystem:
    def __init__(self):
        # Инвентарь игрока
        # Экипировка
        # Золото
        # Словарь всех предметов
        # Настройки системы
```

### Основные компоненты

1. **Инвентарь игрока**

   - Список предметов с количеством
   - Максимальный размер инвентаря
   - Сортировка и фильтрация

2. **Система экипировки**

   - Слоты экипировки (оружие, броня, аксессуары)
   - Бонусы от экипировки
   - Требования к экипировке

3. **Экономика**
   - Золото игрока
   - Цены на предметы
   - Система торговли

## Механики инвентаря

### 1. Система предметов

#### Типы предметов

- **Оружие**: Мечи, топоры, луки, посохи
- **Броня**: Шлемы, нагрудники, поножи, сапоги
- **Аксессуары**: Кольца, амулеты, пояса
- **Зелья**: Здоровье, мана, баффы, дебаффы
- **Подарки**: Цветы, книги, драгоценности
- **Ресурсы**: Травы, руды, материалы
- **Квестовые**: Уникальные предметы для заданий

#### Структура предмета

```python
{
    "id": "rusty_sword",
    "name": "Ржавый меч",
    "description": "Простой железный меч с признаками ржавчины",
    "type": "weapon",
    "rarity": "common",
    "value": 50,
    "weight": 2,
    "requirements": {
        "strength": 3,
        "level": 1
    },
    "effects": {
        "damage": 2,
        "durability": 80
    },
    "stackable": False,
    "usable": True,
    "equippable": True
}
```

### 2. Система экипировки

#### Слоты экипировки

- **Оружие**: Основное оружие (меч, топор, лук)
- **Щит**: Дополнительная защита
- **Шлем**: Защита головы
- **Нагрудник**: Защита тела
- **Поножи**: Защита ног
- **Сапоги**: Защита ног и скорость
- **Кольцо 1**: Магические эффекты
- **Кольцо 2**: Магические эффекты
- **Амулет**: Специальные способности

#### Бонусы экипировки

```python
def calculate_equipment_bonuses():
    # Суммирование бонусов от всей экипировки
    # Применение к характеристикам персонажа
    # Обновление зависимых систем
```

### 3. Система использования предметов

#### Зелья

```python
def use_potion(potion_id):
    # Проверка наличия зелья
    # Применение эффекта
    # Удаление из инвентаря
    # Уведомление игрока
```

**Типы зелий:**

- **Зелье здоровья**: Восстанавливает 20 HP
- **Зелье маны**: Восстанавливает 20 MP
- **Зелье силы**: +2 к силе на 10 минут
- **Зелье интеллекта**: +2 к интеллекту на 10 минут
- **Зелье любви**: +10 к харизме на 5 минут

#### Подарки

```python
def use_gift(gift_id):
    # Проверка контекста (соблазнение)
    # Применение эффекта к цели
    # Удаление из инвентаря
```

### 4. Система торговли

#### Покупка предметов

```python
def buy_item(item_id, quantity=1):
    # Проверка наличия золота
    # Проверка места в инвентаре
    # Списание золота
    # Добавление предмета
```

#### Продажа предметов

```python
def sell_item(item_id, quantity=1):
    # Проверка наличия предмета
    # Расчет цены продажи (50% от покупной)
    # Удаление предмета
    # Добавление золота
```

## Предметы в игре

### 1. Оружие

#### Ржавый меч

```python
{
    "id": "rusty_sword",
    "name": "Ржавый меч",
    "type": "weapon",
    "value": 50,
    "requirements": {"strength": 3, "level": 1},
    "effects": {"damage": 2}
}
```

#### Железный меч

```python
{
    "id": "iron_sword",
    "name": "Железный меч",
    "type": "weapon",
    "value": 150,
    "requirements": {"strength": 5, "level": 3},
    "effects": {"damage": 4}
}
```

#### Стальной меч

```python
{
    "id": "steel_sword",
    "name": "Стальной меч",
    "type": "weapon",
    "value": 300,
    "requirements": {"strength": 8, "level": 5},
    "effects": {"damage": 6}
}
```

### 2. Броня

#### Кожаная броня

```python
{
    "id": "leather_armor",
    "name": "Кожаная броня",
    "type": "armor",
    "value": 80,
    "requirements": {"level": 2},
    "effects": {"defense": 2, "vitality": 1}
}
```

#### Железная броня

```python
{
    "id": "iron_armor",
    "name": "Железная броня",
    "type": "armor",
    "value": 200,
    "requirements": {"strength": 6, "level": 4},
    "effects": {"defense": 4, "vitality": 2}
}
```

### 3. Зелья

#### Зелье здоровья

```python
{
    "id": "health_potion",
    "name": "Зелье здоровья",
    "type": "potion",
    "value": 30,
    "effects": {"heal": 20},
    "usable": True,
    "stackable": True
}
```

#### Зелье маны

```python
{
    "id": "mana_potion",
    "name": "Зелье маны",
    "type": "potion",
    "value": 25,
    "effects": {"mana": 20},
    "usable": True,
    "stackable": True
}
```

### 4. Подарки

#### Цветы

```python
{
    "id": "flowers",
    "name": "Букет цветов",
    "type": "gift",
    "value": 10,
    "effects": {"affection": 10},
    "usable": True,
    "stackable": True
}
```

#### Драгоценности

```python
{
    "id": "jewelry",
    "name": "Драгоценности",
    "type": "gift",
    "value": 100,
    "effects": {"affection": 25},
    "usable": True,
    "stackable": True
}
```

## Управление инвентарем

### 1. Добавление предметов

```python
def add_item(item_id, quantity=1):
    # Проверка места в инвентаре
    # Добавление предмета
    # Обновление интерфейса
    # Уведомление игрока
```

### 2. Удаление предметов

```python
def remove_item(item_id, quantity=1):
    # Проверка наличия предмета
    # Удаление предмета
    # Обновление интерфейса
    # Уведомление игрока
```

### 3. Экипировка предметов

```python
def equip_item(item_id, slot):
    # Проверка требований
    # Снятие текущей экипировки
    # Установка новой экипировки
    # Обновление характеристик
```

### 4. Снятие экипировки

```python
def unequip_item(slot):
    # Проверка наличия экипировки
    # Возврат в инвентарь
    # Обновление характеристик
    # Уведомление игрока
```

## Интеграция с другими системами

### С боевой системой

- Экипировка влияет на боевые характеристики
- Использование зелий в бою
- Получение предметов после победы

### С системой соблазнения

- Использование подарков
- Экипировка влияет на харизму
- Специальные предметы для соблазнения

### С системой прокачки

- Требования к экипировке
- Предметы для тренировок
- Награды за достижения

## API системы

### Основные методы

#### Управление инвентарем

```python
add_item(item_id, quantity)        # Добавить предмет
remove_item(item_id, quantity)     # Удалить предмет
get_inventory_list()               # Список предметов
has_item(item_id, quantity)        # Проверить наличие
```

#### Управление экипировкой

```python
equip_item(item_id, slot)          # Экипировать предмет
unequip_item(slot)                 # Снять экипировку
get_equipped_items()               # Получить экипировку
get_equipment_bonuses()            # Получить бонусы
```

#### Управление экономикой

```python
add_gold(amount)                   # Добавить золото
spend_gold(amount)                 # Потратить золото
get_gold()                         # Получить количество золота
```

#### Использование предметов

```python
use_item(item_id)                  # Использовать предмет
can_use_item(item_id)              # Можно ли использовать
get_item_effects(item_id)          # Получить эффекты предмета
```

### Доступ к данным

```python
inventory_system.inventory          # Инвентарь игрока
inventory_system.equipment          # Экипировка
inventory_system.gold               # Золото
inventory_system.all_items          # Словарь всех предметов
```

## Баланс и настройки

### Базовые значения

- **Начальное золото**: 100
- **Размер инвентаря**: 50 слотов
- **Максимальный стак**: 99 для стакуемых предметов
- **Цена продажи**: 50% от покупной цены

### Цены предметов

- **Ржавый меч**: 50 золота
- **Железный меч**: 150 золота
- **Стальной меч**: 300 золота
- **Кожаная броня**: 80 золота
- **Железная броня**: 200 золота
- **Зелье здоровья**: 30 золота
- **Зелье маны**: 25 золота
- **Цветы**: 10 золота
- **Драгоценности**: 100 золота

### Эффекты экипировки

- **Ржавый меч**: +2 урона
- **Железный меч**: +4 урона
- **Стальной меч**: +6 урона
- **Кожаная броня**: +2 защиты, +1 живучести
- **Железная броня**: +4 защиты, +2 живучести

## Планы развития

### Краткосрочные цели

- [ ] Добавление новых предметов
- [ ] Система крафтинга
- [ ] Улучшение предметов
- [ ] Система редкости

### Долгосрочные цели

- [ ] Многопользовательская торговля
- [ ] Аукционный дом
- [ ] Система гильдий
- [ ] Сезонные предметы

## Тестирование

### Тестовые сценарии

1. **Базовая торговля**: Покупка и продажа предметов
2. **Экипировка**: Надевание и снятие предметов
3. **Использование зелий**: Применение эффектов
4. **Подарки**: Использование в соблазнении
5. **Ограничения**: Проверка требований к экипировке

### Метрики баланса

- Средняя стоимость экипировки: 100-300 золота
- Время накопления на дорогой предмет: 2-4 часа
- Использование зелий: 20-30% боев
- Разнообразие экипировки: Все слоты должны быть полезны

## Заключение

Система инвентаря обеспечивает глубокую кастомизацию персонажа и экономическую составляющую игры. Модульная архитектура позволяет легко добавлять новые предметы и механики, сохраняя при этом баланс экономики.
