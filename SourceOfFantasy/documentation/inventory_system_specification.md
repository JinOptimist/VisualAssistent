# Спецификация системы инвентаря

## Обзор

Система инвентаря предоставляет игроку возможность управлять предметами, экипировкой и ресурсами в игре. Система интегрирована с боевой системой и позволяет использовать предметы во время боя.

## Основные компоненты

### Класс InventorySystem

Основной класс для управления инвентарем игрока.

#### Атрибуты

- `inventory` - словарь предметов в инвентаре
- `max_inventory_size` - максимальный размер инвентаря (20)
- `equipment` - экипированные предметы (weapon, armor, accessory)
- `gold` - количество золота у игрока
- `all_items` - словарь всех доступных предметов в игре

#### Методы

##### Управление предметами

- `add_item(item_id, quantity=1)` - добавляет предмет в инвентарь
- `remove_item(item_id, quantity=1)` - удаляет предмет из инвентаря
- `use_item(item_id)` - использует предмет

##### Экипировка

- `equip_item(item_id)` - экипирует предмет
- `unequip_item(slot)` - снимает экипированный предмет
- `get_equipment_bonuses()` - возвращает бонусы от экипировки

##### Управление ресурсами

- `add_gold(amount)` - добавляет золото
- `spend_gold(amount)` - тратит золото

##### Информационные методы

- `get_inventory_list()` - возвращает список предметов в инвентаре
- `get_equipment_list()` - возвращает список экипированных предметов

## Типы предметов

### Оружие (weapon)

- `rusty_sword` - Ржавый меч (атака +3)
- `iron_sword` - Железный меч (атака +5)
- `magic_staff` - Магический посох (магическая атака +8)

### Броня (armor)

- `leather_armor` - Кожаная броня (защита +2)
- `iron_armor` - Железная броня (защита +4)

### Аксессуары (accessory)

- `charm_ring` - Кольцо очарования (харизма +3)

### Расходники (consumable)

- `health_potion` - Зелье здоровья (восстанавливает 20 HP, может вызвать переполнение кровью)
- `mana_potion` - Зелье маны (восстанавливает 15 MP, может вызвать переполнение маной)

## Интеграция с боевой системой

### Использование в бою

Система инвентаря полностью интегрирована с боевой системой:

1. **Кнопка инвентаря** - расположена справа от портрета героя в боевом экране
2. **Открытие инвентаря** - сохраняет текущее состояние боя
3. **Использование предметов** - применяет эффекты и возвращается к бою
4. **Закрытие инвентаря** - восстанавливает состояние боя

### Механика переполнения

Система поддерживает переполнение здоровья и маны:

- **Переполнение кровью** - при превышении максимального HP
- **Переполнение маной** - при превышении максимального MP
- **Статусы переполнения** - отображаются в боевом экране
- **Уведомления** - игрок получает информацию о переполнении при использовании зелий

### Состояния боя

Боевая система поддерживает следующие состояния:

- `player_turn` - ход игрока
- `enemy_turn` - ход противника
- `inventory_open` - открыт инвентарь
- `battle_end` - бой завершен

### Сохранение состояния

При открытии инвентаря во время боя:

1. Сохраняется текущее состояние боя
2. Открывается экран инвентаря
3. При закрытии восстанавливается состояние
4. Бой продолжается с того места, где остановился

## Экран инвентаря

### Структура экрана

1. **Заголовок** - название и количество золота
2. **Левая панель** - список предметов с возможностью использования
3. **Правая панель** - информация об экипировке и бонусах
4. **Кнопка закрытия** - возврат к бою

### Функциональность

- **Просмотр предметов** - отображение всех предметов в инвентаре
- **Использование расходников** - немедленное применение зелий
- **Экипировка** - надевание оружия, брони и аксессуаров
- **Снятие экипировки** - возврат предметов в инвентарь
- **Просмотр бонусов** - отображение текущих бонусов от экипировки

## Тестирование

### Тестовые сценарии

1. **test_inventory_battle** - полный набор предметов для тестирования
2. **battle_scene_goblin** - базовый бой с тестовыми предметами

### Проверяемые функции

- Открытие/закрытие инвентаря во время боя
- Использование зелий здоровья и маны
- Экипировка и снятие предметов
- Сохранение состояния боя
- Уведомления о действиях с предметами

## Будущие улучшения

1. **Категории предметов** - группировка по типам
2. **Фильтрация** - поиск и сортировка предметов
3. **Описание предметов** - детальная информация при наведении
4. **Анимации** - плавные переходы между экранами
5. **Звуковые эффекты** - аудио при использовании предметов
